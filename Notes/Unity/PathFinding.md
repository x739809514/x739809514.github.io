## 多边形漏斗算法

### 核心思想

- 计算七点与第一条目标边界向量位置关系，明确左右向量。**（漏斗初始化）**

- 分别标记左右向量索引，在相邻多边形中，计算下一个左右店。

- 依次遍历所有极限，分别对比新位置向量与历史左右极限向量位置关系。

  - 左向向左，扩张漏斗；漏斗顶点不变，左极限向量不变，左拐点Lst（缓存）添加当前左极限点。

  - 左向向右，收缩漏斗；未越过右极限向量：漏斗顶点不变，左极限更新到左监测点，左拐点清空历史数据。

  - 左向向右，收缩漏斗，已越过右极限向量：添加当前右极限点为路径点；遍历右拐点Lst，**计算出右向最小角度偏移顶点**，更新漏斗顶点与右极限向量至合法状态。

    ---------------------------------------------------------------------------------------------------------

  - 右向向右，扩张漏斗；漏斗定点不变，右极限向量不变，右拐点Lst添加当前右极限点；

  - 右向向左，收缩漏斗，未越过左极限向量：漏斗顶点不变，右极限更新到右检测点，右拐点Lst清空历史数据。

  - 右向向左，收缩漏斗，已越过左极限向量：添加当前左极限点为路径点；遍历左拐点Lst，**计算出左向最小角度偏移顶点**，更新漏斗顶点与左极限向量至合法状态。

- 到达目标区域顶点时，分别以该点为左右收缩目标：

  - 在左极限左边，添加左点为拐点，目标点为终点
  - 在左右极限中间，可直通，目标点为终点；
  - 在右极限右边，添加右点为拐点，目标点为终点；

- 输出所有路径点

### 算法实现：

https://github.com/x739809514/PathFinding_Algorithms/tree/main/Assets/Scripts/FunnelAlgorithm

